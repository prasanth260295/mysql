
create table FEE_DEFINITION
(
   FEE_DEF_ID number(30) not null,
   FEE_DEF_TYPE varchar2(30) not null,
   INSTITUTION_ID varchar2(30) not null,
   FEE_CODE varchar2(50) not null,
   FEE_NAME varchar2(500) not null,
   FEE_TRANCODE varchar2(10) not null,
   METRIC_NAME varchar2(50),
   METRIC_TYPE varchar2(50),
   TRANCODES varchar2(500),
   MEMO_POST_FLAG number(1),
   primary key (FEE_DEF_ID)
);

create sequence FEE_DEF_ID_SEQ;

create table FEE_SCHEDULE
(
   SCHEDULE_ID number(30) not null,
   INSTITUTION_ID varchar2(30) not null,
   SCHEDULE_NAME varchar2(500) not null,
   PARENT_ID number(30),
   primary key (SCHEDULE_ID)
);

create sequence SCHEDULE_ID_SEQ;

create table AMOUNT_CALCULATOR
(
   CALCULATOR_ID number(30) not null,
   CALCULATION varchar2(100) not null,
   FIXED_AMOUNT number(20, 5),
   RATE number(20, 5),
   FLOOR number(20, 5),
   CEILING number(20, 5),
   SLABS varchar2(500),
   primary key (CALCULATOR_ID)
);

create sequence CALCULATOR_ID_SEQ;

create table FEE_SCHEDULE_ENTRY
(
   ENTRY_ID number(30) not null,
   FEE_DEF_TYPE varchar2(30) not null,
   SCHEDULE_ID number(30) null,
   FEE_DEF_ID number(30) not null,
   FEE_CYCLE_TYPE varchar2(30) null,
   FEECYCLE_TIMEPARTUNIT varchar2(100),
   FEECYCLE_TIMEPARTUNIT_VALUE number(3),
   ANALYSIS_FLAG NUMBER(1),
   CALCULATOR_ID number(30),
   GRACE_DAYS_COUNT number(3),
   DORMANCY_FEE_PER_CYCLE number(20, 5),
   BALANCE_TYPE varchar2(50),
   OVERDRAFT_FEE_PER_DAY number(20, 5),
   primary key (ENTRY_ID)
);

create sequence FEE_SCHEDULE_ENTRY_ID_SEQ;

create table FEE_CONTEXT
(
   FEE_CONTEXT_ID number(30) not null,
   FEE_DEF_TYPE varchar2(30) not null,
   ENTRY_ID number(30) not null,
   METRIC_TYPE varchar2(50),
   ACCRUAL varchar2(50),
   ACCOUNT_ID number(30),
   DATE_RANGES varchar2(50),
   NSF_COUNT number(3),
   RETURN_ITEM_COUNT number(3),
   primary key (FEE_CONTEXT_ID)
);

create sequence FEE_CTX_ID_SEQ;

create table FEE_SERVICE
(
   FEE_SERVICE_ID number(30) not null,
   ACCOUNT_ID number(30) not null,
   ENTRY_ID number(30) not null,
   FEE_CONTEXT_ID number(30),
   primary key (FEE_SERVICE_ID)
);

create sequence FEE_SERVICE_ID_SEQ;

create table ADHOC_FEE_EVENT
(
   FEE_EVENT_ID number(30) NOT NULL,
   EVENT_INDEX number(30),
   FEE_CONTEXT_ID number(30),
   METRIC_TYPE varchar2(50),
   USAGE varchar2(50),
   primary key (FEE_EVENT_ID)
);

create sequence FEE_EVENT_ID_SEQ;

create table FEE
(
   FEE_ID number(30) not null,
   FEE_SERVICE_ID number(30),
   FEE_INDEX number(30),
   FEE_TRANCODE varchar2(10) not null,
   AMOUNT number(20, 5),
   STATUS varchar2(10) not null,
   FEE_CONTEXT_ID number(30) not null,
   primary key (FEE_ID)
);

create sequence FEE_ID_SEQ;

alter table DEPOSIT_ACCOUNT add (
	SCHEDULE_ID number(30) 
);

alter table PRODUCT add (
	SCHEDULE_ID number(30) 
);

alter table APPL_PRODUCT add (
	SCHEDULE_ID number(30) 
);

-- Adding Service Charge Schedule Id to DEPOSIT_ACCOUNT_VW
	
CREATE OR REPLACE VIEW DEPOSIT_ACCOUNT_VW AS
SELECT
DA.CUSTOMER_ID ,
DA.ACCOUNT_ID ,
DA.NUMBER_DAYS_PENALTY ,
DA.PENALTY_END_DATE ,
DA.PAYOFF ,
DA.STATE_WITHHOLD_AMT_CURR_PERIOD ,
DA.DATE_ORIG_ISSUE ,
DA.RENEWAL_BALANCE ,
DA.DATE_30DAY_NOTICE_EXPIRE ,
DA.COLLECTED_BALANCE ,
DA.EFFECTIVE_RATE ,
DA.ANNUAL_PERCENTAGE_YIELD ,
DA.AGGR_UNCOLL_BAL_CURR_PERIOD ,
DA.MEMO_POSTED_CREDITS ,
DA.MEMO_POSTED_DEBITS ,
DA.HOLD_AMOUNT ,
DA.TIMES_DAU_YTD ,
DA.NEXT_STMT_DATE ,
DA.HIGH_BALANCE ,
DA.PROCEEDS_FRABA ,
DA.QTD_INTEREST ,
DA.PRE_CHECK_AMOUNT ,
DA.PARTY_ID ,
DA.CURRENCY ,
DA.WAIVER_ACTIVITY_SC ,
DA.SAVINGS_BALANCE ,
DA.OPENING_DEPOSIT ,
DA.OPENING_DEPOSIT_TYPE ,
DA.BASE_INDEX ,
DA.MIN_NO_OF_AUTH_SIGNERS ,
DA.DUPLICATE_CD_FORM_STATUS ,
DA.DUPLICATE_CD_ISSUED ,
DA.MODE_OF_OPERATION ,
DA.INTEREST_EARNED_LIFE_TEMP ,
DA.LAST_SERVICE_CHARGE ,
DA.NO_OF_ATM_USED_YTD ,
DA.OWNERSHIP_DESIGNATION ,
DA.STATE_TAX_WHELD_YTD ,
DA.STMT_OPENING_BAL ,
DA.STMT_OPENING_DATE ,
DA.OLD_KITE_BALANCE ,
DA.LAST_ACTIVITY_DATE ,
DA.MULTIPLE_SIGNATURES ,
DA.NEXT_INTEREST_PAYMENT ,
DA.SMSA ,
DA.CRA_LOCATION ,
DA.CENSUS_TRACK ,
DA.MATURITY_DISB_CODE ,
DA.INTEREST_PAID_YTD ,
DA.ORIGINAL_BALANCE ,
DA.PENALTY_PAID_LTD ,
DA.PENALTY_PAID_PYTD ,
DA.PROCEEDS_BANK ,
DA.MINIMUM_BALANCE ,
DA.PASSBOOK_STMT_FLAG ,
DA.OPENING_BRANCH ,
DA.SRV_CHRG_EX_ACT_CURR_PERIOD ,
DA.NUMBER_PERIODS_YEAR_TO_DATE ,
DA.TRANSFER_ACCOUNT ,
DA.SERVICE_CHARGE_DDA_ACCOUNT_NO ,
DA.SERVICE_CHARGE_DDA_AMOUNT ,
DA.TAXABLE_INTEREST_CODE ,
DA.SRV_CHRG_INACT_CURR_PERIOD ,
DA.SRV_CHRG_INACT_CURR_PERIOD_WD ,
DA.SRV_CHRG_ACCOUNT_CLOSING ,
DA.NUMBER_UNPOSTED_PASSBOOK_ITEMS ,
DA.AMOUNT_UNPOSTED_PASSBOOK_ITEMS ,
DA.AMT_UNPOSTED_PASSBOOK_INTEREST ,
DA.GOLDEN_SAVINGS_DEFERR_INTEREST ,
DA.GOLDEN_SAVINGS_RCD_DATE ,
DA.GOLDEN_SAVINGS_MVBR ,
DA.GOLDEN_SAVINGS_VIOLATION_FLAG ,
DA.FORFEITURE_AMOUNT ,
DA.INTEREST_PAID_LIFE_AT_LAST_RNL ,
DA.DATE_EXPIRY ,
DA.ORIGINAL_AMOUNT ,
DA.COMPOUND_FLAG ,
DA.LEVEL_INTEREST_PAYMENT_CODE ,
DA.NUMBER_PAYMENTS_TO_DATE ,
DA.PAYMENTS_REMAINING ,
DA.HELD_IN_SAFEKEEPING ,
DA.BANK_DAY_1 ,
DA.BANK_DAY_2 ,
DA.BANK_DAY_3 ,
DA.BANK_DAY_4 ,
DA.BANK_DAY_5 ,
DA.BANK_DAY_6 ,
DA.BANK_DAY_7 ,
DA.CUSTOMER_DAY_1 ,
DA.CUSTOMER_DAY_2 ,
DA.CUSTOMER_DAY_3 ,
DA.CUSTOMER_DAY_4 ,
DA.CUSTOMER_DAY_5 ,
DA.CUSTOMER_DAY_6 ,
DA.CUSTOMER_DAY_7 ,
DA.BRANCH_ID ,
DA.CLASS_CODE ,
DA.USER_CODE_1 ,
DA.USER_CODE_2 ,
DA.USER_CODE_3 ,
DA.USER_CODE_4 ,
DA.USER_CODE_5 ,
DA.USER_CODE_6 ,
DA.USER_CODE_7 ,
DA.USER_CODE_8 ,
DA.USER_CODE_9 ,
DA.DATE_OPENED ,
DA.ALLOWED_OD_AMOUNT ,
DA.DEALER_NUMBER ,
DA.SERVICE_CHARGE_ACTIVITY_CODE ,
DA.SSN_TAX_PAYER_ID ,
DA.PRIORITY_CODE ,
DA.ATF_FEE_WAIVER ,
DA.NOW_CLASS_CODE ,
DA.ALERT_INDICATOR ,
DA.ALTERNATE_MAILING_ADDRESS_CODE ,
DA.CYCLE_CODE_LOCK_FLAG ,
DA.ESTATEMENT_CODE ,
DA.INTEREST_PROCEEDS_CODE ,
DA.IRS_REPORTING_CODE ,
DA.PREVIOUS_OFFICER_CODE ,
DA.OLD_ACCOUNT_NUMBER ,
DA.OVERDRAFT_LIMIT_CODE ,
DA.PREVIOUS_CLASS_CODE ,
DA.PREVIOUS_CYCLE_CODE ,
DA.PRODUCT_CODE ,
DA.PRODUCT_SOURCE ,
DA.SERVICE_CHARGE_BILL_CODE ,
DA.SERVICE_CHRG_SAVINGS_ACC_NO ,
DA.SERVICE_CHARGE_SAVINGS_CODE ,
DA.STATEMENT_CYCLE_CODE ,
DA.STATEMENT_FORMAT_CODE ,
DA.STATEMENT_MESSAGE_CODE ,
DA.STATEMENT_RELATIONSHIP_CODE ,
DA.STATEMENT_SUMMARY_CODE ,
DA.STATUS_FLAG ,
DA.STOP_CODE ,
DA.WAIVE_INACTIVE_SERV_CHRG_FLAG ,
DA.WAIVE_CLOSED_ACC_SRV_CHRG_FLAG ,
DA.SYSTEM_DATE ,
DA.POSTING_DATE ,
DA.USER_ID ,
DA.CHARGED_OFF ,
DA.STOP_PAYS ,
DA.PAY_ON_UNCOLLECTED ,
DA.ACH_NEXT_DAY_POST_AMT ,
DA.SPECIAL_INSTRUCTIONS ,
DA.INTEREST_CODE ,
DA.CHECK_PROTECTION ,
DA.STATUS ,
DA.TRUST_FUND_INDICATOR ,
DA.HOW_STATEMENT_PULLED ,
DA.SERVICE_CHARGES ,
DA.CHECK_SAFEKEEPING ,
DA.STOP_HOLD_CODE ,
DA.SERVICE_CHARGE_CODE ,
DA.CARD_HOLDER_NAME ,
DA.CARD_STATUS ,
DA.TIMES_ATM_USED_YTD ,
DA.RELAIONSHIP_STATEMENT ,
DA.CARD_HOLDER_NUMBER ,
DA.ON_CALL_SAVING ,
DA.CURRENT_AMOUNT_FLOAT ,
DA.EMPLOYEE ,
DA.WIRE_TELLER_CHECK ,
DA.OVERNIGHT_REPURCHASE ,
DA.ACH_EXTRACTED_POST_AMT ,
DA.CLOSING_CHARGE ,
DA.CORR_BANK_INDIC ,
D.PREV_KITING_DATE ,
D.NO_TIMES_EXCESS_REGD_RPT ,
D.PREV_NO_DEPOSITS_CURR_PERIOD ,
D.PREV_NO_ATM_DEBITS ,
D.PREV_SRV_CHRG_ACT_CURR_PERIOD ,
D.PREV_SRV_CHRG_MAINTCURR_PERIOD ,
D.PREV_TIMES_OD_CURR_PERIOD ,
D.PREV_TIMES_NSF_CURR_PERIOD ,
D.PREV_NO_DAYS_OD_CURR_PERIOD ,
D.PREV_INTEREST_PAID_PTD ,
D.PREV_AGGR_BALANCE_CURR_PERIOD ,
D.PREV_NO_ENCLOSURE_CURR_PERIOD ,
D.PREV_TIMES_KITING_CURR_PERIOD ,
D.PREV_NO_OF_POSTING_DAYS ,
D.RETURNED_ITEM_FEE_PTD ,
D.OD_FEE_PTD ,
D.PREV_RETURNED_ITEM_FEE_PTD ,
D.PREV_OD_FEE_PTD ,
D.PROCEEDS_CODE ,
D.FED_WITHHOLDING_CODE ,
D.STATE_WITHHOLDING_CODE ,
D.TIMES_OD_YTD ,
D.TIMES_OD_CURR_PERIOD ,
D.SRV_CHRG_ACT_CURR_PERIOD ,
D.FACE_AMOUNT ,
D.MATURITY_AUTO_RENEW ,
D.BAL_SUBJECT_TO_PENALTY ,
D.RENEWAL_INTEREST_RATE ,
D.EQUAL_INT_PAYMENT_IND ,
D.INT_REPORT_NOT_PAID ,
D.INTEREST_FREQUENCY ,
D.ONE_UP ,
D.TIMES_KITING_YTD ,
D.PENALTY_ID ,
D.INTEREST_DAY_OF_MONTH ,
D.RATE_CHANGE_FREQUENCY ,
D.PRIOR_YEAR_INTEREST_FORFEITED ,
D.PYR_INT_REPORTED_NOT_PAID ,
D.TIMES_KITING_PRYR ,
DA.PLAN_ID ,
D.NO_OF_CHECKS ,
D.NO_TRANSIT_ITEMS ,
D.WAIVER_DIRECT_SC ,
D.TOT_ACT_CHG_WAV ,
D.NO_OF_POSTING_DAYS ,
D.NO_CHECKS_PAID_FLOAT ,
D.NO_ACH_CREDITS ,
D.NO_ATM_DEBITS ,
D.NO_ATM_CREDITS ,
D.CALL_REPORT_CODE ,
D.CLUB_PAYMENT_CODE ,
D.INTEREST_CALCULATION ,
D.INITIAL_INTEREST_RATE ,
D.CLUB_PAYMENT_AMOUNT ,
D.DAU_CHARGE ,
D.OD_CHARGE ,
D.NSF_CHARGE ,
D.IS_PAYROLL_ACCOUNT ,
D.CERTIFICATE_NUMBER ,
D.DATE_LAST_ACTIVITY ,
D.TAX_CODE ,
D.AGG_BALANCE_YTD ,
D.DATE_LAST_EXTERNAL_DEBIT_ACTY ,
D.STATE_TAX_WHELD_PTD ,
D.FED_WITHHOLD_AMT_CURR_PERIOD ,
D.FED_WITHHOLD_AMT_YEAR_TO_DATE ,
D.DATE_FIRST_OVERDRAWN ,
D.PROCEEDS_ACCOUNT_ID ,
D.DATE_PREVIOUS_ACTIVITY ,
D.IS_PUBLIC_FUND ,
D.DATE_LAST_KITING ,
D.OLD_KITE_DEBITS ,
D.OLD_KITE_CREDITS ,
D.OLD_INTEREST_RATE ,
D.OPENING_BALANCE ,
D.NO_TIMES_EXCESS_MMA_RPT ,
D.PREVIOUS_BALANCE ,
D.PREVIOUS_STMT_DATE ,
D.RETURNS_LAST_YR ,
D.PAID_OUT_DATE ,
D.PREV_AMT_CREDITS_CURR_PERIOD ,
D.PREV_AMT_DEBITS_CURR_PERIOD ,
D.PREV_NO_DEBITS_CURRENT_PERIOD ,
D.PREV_NO_CREDITS_CURRENT_PERIOD ,
D.PREV_NO_ACH_DEBITS_CURR_PERIOD ,
D.PREV_NO_TRANSIT_ITEMS ,
D.PREV_NO_OF_CHECKS ,
D.PREV_FED_WITHOLD_AMT_CURR_PTD ,
D.MATURITY_DATE ,
D.CLUB_AMOUNT ,
D.CLUB_NUMBER_PAYMENTS ,
D.PROCEEDS_ACCOUNT_NUMBER ,
D.COLLATERAL_PLEDGE_CODE ,
D.TERM ,
D.ACCUM_INTEREST_NOT_PAID ,
D.DAILY_ACCURAL_FACTOR ,
D.PENALTY_AMOUNT ,
D.DATE_LAST_INTEREST ,
D.AMOUNT_OF_LAST_INTEREST ,
D.DATE_LAST_RENEWED ,
D.NEW_CLOSED_DAYS_COUNTER ,
D.CD_TYPE ,
D.MIS_DATA_CODE ,
D.AMT_OF_CREDITS_CURRENT_PERIOD ,
D.NO_CREDITS_CURRENT_PERIOD ,
D.AMT_OF_DEBITS_CURRENT_PERIOD ,
D.NO_DEBITS_CURRENT_PERIOD ,
D.NO_ENCLOSURE_CURRENT_PERIOD ,
D.NO_DEPOSITS_CURRENT_PERIOD ,
D.SRV_CHRG_MAINTCURR_PERIOD ,
D.DATE_OVERDRAWN ,
D.AMT_ORIGINAL_OVERDRAFT ,
D.AGG_OVERDRAFT_BAL_CURR_PERIOD ,
D.NO_DAYS_OVERDRAWN_CURR_PERIOD ,
D.NO_DAYS_OVERDRAWN_YR_TO_DATE ,
D.TIMES_NSF_YTD ,
D.NO_CHRG_BACK_ITEMS_YR_TO_DATE ,
D.TIMES_OD_PRYR ,
D.NO_DAYS_OVERDRAWN_PRIOR_YEAR ,
D.NO_ACH_DEBITS_CURRENT_PERIOD ,
D.NO_PAPER_CREDITS_CURR_PERIOD ,
D.NO_LOCAL_ITEMS_DEP_CURR_PERIOD ,
D.TIMES_KITING_CURR_PERIOD ,
D.INTEREST_PAID_PTD ,
D.DATE_ATM_LAST_USED ,
D.AVG_UNCOLLECT_BAL_CURR_PERIOD ,
D.INTEREST_EARNED_LIFE ,
D.RENEWED_AMOUNT ,
D.CD_PRE_CHECK_AMOUNT ,
D.NEGOTIABLE_CODE ,
D.NUMBER_OF_TIMES_RENEWED ,
D.INTEREST_CHANGE_RATE ,
D.DAYS_PER_YEAR ,
D.RATE_CHANGE_CODE ,
D.PREMIUM_CD_RATE ,
D.DATE_ACCOUNT_REOPEN ,
D.YTD_AVERAGE_BALANCE ,
D.INTEREST_FORFIETED ,
D.DATE_NEXT_INTEREST ,
D.TIMES_NSF_CURR_PERIOD ,
D.STATUS_CODE ,
D.OVERDRAFT_CODE ,
D.CONF_STMT_FLAG ,
D.NEW_ACCOUNT_FLAG ,
D.PROFIT_CENTER ,
D.ACH_POSTING_CODE ,
D.ACH_NOTICE_CODE ,
D.HOLD_CODE ,
D.SECURED_DEPOSIT_INDICATOR ,
D.ACCRUAL_KEY ,
D.UNCOLLECTED_BALANCE ,
D.AVAILABLE_BALANCE ,
D.ACCRUED_INTEREST ,
D.YTD_INTEREST ,
D.AGGR_BALANCE_CURRENT_PERIOD ,
D.PRIOR_YEAR_INTEREST ,
D.OVERDRAFT_LIMIT ,
D.AMOUNT_DEPOSIT_LAST ,
D.LOW_BALANCE_CURRENT_PERIOD ,
D.LAST_WITHDRAWN_AMOUNT ,
D.LAST_CUSTOMER_ACTIVITY ,
D.DATE_LAST_MAINTAINED ,
D.DATE_LAST_DEPOSIT ,
D.DATE_LAST_WITHDRAWAL ,
D.DATE_CLOSED ,
D.INTEREST_RATE ,
DA.ASSIGNED_BRANCH ,
D.ASSIGNED_OFFICER ,
D.CURRENT_STATEMENT_CYCLE ,
D.TIMES_ATM_USED_TOTAL ,
D.NO_OF_ATM_CASH_WITHDRAWL ,
D.LAST_STMT_DATE ,
D.BAL_FWD_LAST_STMT ,
D.CURRENT_BALANCE ,
D.AVG_BALANCE_CURRENT_PERIOD ,
D.AVG_BALANCE_PREV_PERIOD ,
D.LEDGER_BALANCE ,
D.ANTICIPATED_INTEREST ,
D.PROJECTED_ACCRUED_INTEREST ,
D.ACCOUNT_NO ,
D.CREATION_DATE ,
D.BUSINESS_DATE ,
D.LAST_PROCESSED_DATE ,
A.ACCOUNT_CATEGORY ,
A.INSTITUTION_ID ,
A.PRODUCT_ID ,
D.ACCOUNT_TYPE_ID ,
A.PRODUCT_INSTANCE_UID,
DA.SCHEDULE_ID
FROM DEPOSIT_ACCOUNT DA , ACCOUNT A , DEPOSIT D
WHERE A.ACCOUNT_ID = D.ACCOUNT_ID
AND A.ACCOUNT_ID = DA.ACCOUNT_ID;
