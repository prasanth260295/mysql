----Class Toatl Sql---1

--BRANCH Wise Totals
CREATE
	OR
REPLACE
	VIEW DEPOSIT_CLASS_CODE_TOTALS_VW AS 
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	a.BRANCH_ID,
	a.BRANCH_NAME,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.INSTITUTION_ID,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR  pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.INSTITUTION_ID,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.INSTITUTION_ID,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.INSTITUTION_ID,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.BRANCH_ID=b.BRANCH_ID(+) AND
	a.BRANCH_ID=C.BRANCH_ID(+) AND
	a.BRANCH_ID=d.BRANCH_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	b.BRANCH_ID,
	b.BRANCH_NAME,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.INSTITUTION_ID,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.INSTITUTION_ID,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.INSTITUTION_ID ,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.INSTITUTION_ID,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_type_id 
	)
	d 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.BRANCH_ID=a.BRANCH_ID(+) AND
	b.BRANCH_ID=C.BRANCH_ID(+) AND
	b.BRANCH_ID=d.BRANCH_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	C.BRANCH_ID,
	C.BRANCH_NAME,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.BRANCH_ID=a.BRANCH_ID(+) AND
	C.BRANCH_ID=b.BRANCH_ID(+) AND
	C.BRANCH_ID=d.BRANCH_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	d.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	d.BRANCH_ID,
	d.BRANCH_NAME,
	d.INSTITUTION_NAME,
	d.PRODUCT_TYPE_ID,
	d.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.INSTITUTION_ID,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.INSTITUTION_ID,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.INSTITUTION_ID ,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.INSTITUTION_ID,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.BRANCH_ID=a.BRANCH_ID(+) AND
	d.BRANCH_ID=b.BRANCH_ID(+) AND
	d.BRANCH_ID=C.BRANCH_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
	--Now Accounts
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	a.BRANCH_ID,
	a.BRANCH_NAME,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			b.BRANCH_ID,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	e 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	a.BRANCH_ID=b.BRANCH_ID(+) AND
	a.BRANCH_ID=C.BRANCH_ID(+) AND
	a.BRANCH_ID=d.BRANCH_ID(+) AND
	a.BRANCH_ID=e.BRANCH_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	b.BRANCH_ID,
	b.BRANCH_NAME,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id ,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id =i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id ,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id =pt.UNIQUE_ID AND
			DAV.institution_id =i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			b.BRANCH_ID,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id =i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id ,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id =i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id ,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id =i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id ,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	e 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	b.BRANCH_ID=a.BRANCH_ID(+) AND
	b.BRANCH_ID=C.BRANCH_ID(+) AND
	b.BRANCH_ID=d.BRANCH_ID(+) AND
	b.BRANCH_ID=e.BRANCH_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	C.BRANCH_ID,
	C.BRANCH_NAME,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id =pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			b.BRANCH_ID,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id =pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	e 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	C.BRANCH_ID=a.BRANCH_ID(+) AND
	C.BRANCH_ID=b.BRANCH_ID(+) AND
	C.BRANCH_ID=d.BRANCH_ID(+) AND
	C.BRANCH_ID=e.BRANCH_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	d.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	d.BRANCH_ID,
	d.BRANCH_NAME,
	d.INSTITUTION_NAME,
	d.PRODUCT_TYPE_ID,
	d.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.INSTITUTION_ID,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.INSTITUTION_ID,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.INSTITUTION_ID,
			b.BRANCH_ID,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.INSTITUTION_ID,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.INSTITUTION_ID,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.INSTITUTION_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	e 
WHERE
	d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	d.BRANCH_ID=a.BRANCH_ID(+) AND
	d.BRANCH_ID=b.BRANCH_ID(+) AND
	d.BRANCH_ID=C.BRANCH_ID(+) AND
	d.BRANCH_ID=e.BRANCH_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	e.acc_type,
	e.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	e.BRANCH_ID,
	e.BRANCH_NAME,
	e.INSTITUTION_NAME,
	e.PRODUCT_TYPE_ID,
	e.PRODUCT_CATEGORY,
	e.PRODUCT_TYPE_DESC,
	e.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			b.BRANCH_ID,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			b.BRANCH_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	e 
WHERE
	e.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	e.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	e.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	e.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	e.BRANCH_ID=a.BRANCH_ID(+) AND
	e.BRANCH_ID=b.BRANCH_ID(+) AND
	e.BRANCH_ID=C.BRANCH_ID(+) AND
	e.BRANCH_ID=d.BRANCH_ID(+) AND
	e.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
	-- for Savings accounts
	
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	a.BRANCH_ID,
	a.BRANCH_NAME,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum 
FROM
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.BRANCH_ID=b.BRANCH_ID(+) AND
	a.BRANCH_ID=C.BRANCH_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	b.BRANCH_ID,
	b.BRANCH_NAME,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum 
FROM
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.BRANCH_ID=a.BRANCH_ID(+) AND
	b.BRANCH_ID=C.BRANCH_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	C.BRANCH_ID,
	C.BRANCH_NAME,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	C.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum 
FROM
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.BRANCH_ID=a.BRANCH_ID(+) AND
	C.BRANCH_ID=b.BRANCH_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) 
UNION
	-- for CD accounts
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	a.BRANCH_ID,
	a.BRANCH_NAME,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			( DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.BRANCH_ID=b.BRANCH_ID(+) AND
	a.BRANCH_ID=C.BRANCH_ID(+) AND
	a.BRANCH_ID=d.BRANCH_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+)
	-----
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	b.BRANCH_ID,
	b.BRANCH_NAME,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.BRANCH_ID=a.BRANCH_ID(+) AND
	b.BRANCH_ID=C.BRANCH_ID(+) AND
	b.BRANCH_ID=d.BRANCH_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
	-----
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	C.BRANCH_ID,
	C.BRANCH_NAME,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	C.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.BRANCH_ID=a.BRANCH_ID(+) AND
	C.BRANCH_ID=b.BRANCH_ID(+) AND
	C.BRANCH_ID=d.BRANCH_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	d.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	d.BRANCH_ID,
	d.BRANCH_NAME,
	d.INSTITUTION_NAME,
	d.PRODUCT_TYPE_ID,
	d.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			BRANCH b,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			b.unique_id=DAV.ASSIGNED_BRANCH AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			b.BRANCH_ID,
			b.BRANCH_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID 
	)
	d 
WHERE
	d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.BRANCH_ID=a.BRANCH_ID(+) AND
	d.BRANCH_ID=b.BRANCH_ID(+) AND
	d.BRANCH_ID=C.BRANCH_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+);




---Bank Totals

CREATE
	OR
REPLACE
	VIEW DEPOSIT_CLASS_CODE_TOT_BANK_VW AS
	--DDA Accounts
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
						DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
		
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID AND
			DAV.institution_id=i.INSTITUTION_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
		
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
	
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	d.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	d.INSTITUTION_NAME,
	d.PRODUCT_TYPE_ID,
	d.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID AND
			DAV.institution_id=i.INSTITUTION_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) 
UNION
	--Now Accounts
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID AND
			DAV.institution_id=i.INSTITUTION_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	e.acc_type,
	e.INSTITUTION_ID,
	d.accounts_count,
	a.ledger_balance_sum,
	e.INSTITUTION_NAME,
	e.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	e.PRODUCT_TYPE_DESC,
	e.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum 
FROM
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.LEDGER_BALANCE < 0 AND
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			DAV.institution_id,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	e.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	e.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	e.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	e.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	e.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
	-- for Savings accounts
	
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum 
FROM
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum 
FROM
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum 
FROM
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'SAV' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='21' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) 
UNION
	-- for CD accounts
SELECT
	a.acc_type,
	a.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	a.INSTITUTION_NAME,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	b.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	b.INSTITUTION_NAME,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	C.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	C.INSTITUTION_NAME,
	C.PRODUCT_TYPE_ID,
	C.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			( DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	d.INSTITUTION_ID,
	a.accounts_count,
	a.ledger_balance_sum,
	d.INSTITUTION_NAME,
	d.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum 
FROM
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.ACCOUNT_TYPE_ID='22' AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			DAV.institution_id,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			( DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.ACCOUNT_TYPE_ID='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			DAV.institution_id,
			i.INSTITUTION_NAME,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.ACCOUNT_TYPE_ID 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.institution_id ,
			DAV.ACCOUNT_TYPE_ID,
			i.INSTITUTION_NAME,
			pt.PRODUCT_TYPE_DESC 
		FROM
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			INSTITUTION i 
		WHERE
			DAV.product_id=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.institution_id=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='22' 
		GROUP BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.institution_id,
			i.INSTITUTION_NAME,
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+);



-------------------

---Class Toatl Summary Level view--2

CREATE
	OR
REPLACE
	VIEW DEPOSIT_CLASS_CODE_SUMMARY_VW AS
	--DDA Accounts
SELECT
	a.acc_type,
	d.accounts_count,
	a.ledger_balance_sum,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'DDA' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE
		    
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
				
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	d.accounts_count,
	a.ledger_balance_sum,
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'DDA' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID

	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	d.accounts_count,
	a.ledger_balance_sum,
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(SELECT
			'DDA' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.ACCOUNT_TYPE_ID,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.ACCOUNT_TYPE_ID='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.ACCOUNT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID

	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
where-- C.INSTITUTION_ID=a.INSTITUTION_ID(+)
	--and c.INSTITUTION_ID=b.INSTITUTION_ID(+)
	--and c.INSTITUTION_ID=d.INSTITUTION_ID(+)
	--and 
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	d.accounts_count,
	a.ledger_balance_sum,
	d.PRODUCT_TYPE_ID,
	d.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(SELECT
			'DDA' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'DDA' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'DDA' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='FALSE' OR pf.DEFAULT_VALUE='False') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d


	 
	--where d.INSTITUTION_ID=b.INSTITUTION_ID(+)
	--and d.INSTITUTION_ID=c.INSTITUTION_ID(+)
	--and d.INSTITUTION_ID=a.INSTITUTION_ID(+)
	--and
WHERE
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) 
UNION
	--Now Accounts
SELECT
	a.acc_type,
	d.accounts_count,
	a.ledger_balance_sum,
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e
--where a.INSTITUTION_ID=b.INSTITUTION_ID(+)
	----and   a.INSTITUTION_ID=c.INSTITUTION_ID(+)
	----and   a.INSTITUTION_ID=d.INSTITUTION_ID(+)
	--and   a.INSTITUTION_ID=e.INSTITUTION_ID(+)
	--and 
WHERE
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	d.accounts_count,
	a.ledger_balance_sum,
     b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e

	--b.INSTITUTION_ID=a.INSTITUTION_ID(+)
	--and   b.INSTITUTION_ID=c.INSTITUTION_ID(+)
	--and   b.INSTITUTION_ID=d.INSTITUTION_ID(+)
	--and   b.INSTITUTION_ID=e.INSTITUTION_ID(+)
	--and 
WHERE
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	
	d.accounts_count,
	a.ledger_balance_sum,
	
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p --/home/a1224/.m2/repository/com/vsoftcorp/deposits/
			--deposits-cli-application/1.0.78/deposits-cli-application-1.0.78.jar 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC --/home/a1224/.m2/repository/com/vsoftcorp/
			--posits/deposits-cli-application/1.0.78/deposits-cli-application-1.
			--0.78.jar 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	--C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	--C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	--C.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	--C.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	
	d.accounts_count,
	a.ledger_balance_sum,
	
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	--d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
--	d.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
--	d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
--	d.INSTITUTION_ID=e.INSTITUTION_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=e.PRODUCT_TYPE_ID(+) 

UNION
SELECT
	e.acc_type,
	
	d.accounts_count,
	a.ledger_balance_sum,
	
	e.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	e.PRODUCT_TYPE_DESC,
	e.ACCOUNT_TYPE_ID,
	e.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	C.dormant_count,
	C.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE>0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'NOW' acc_type,
			SUM(ledger_balance) od_balance_sum,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY ,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.LEDGER_BALANCE < 0 AND
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'NOW' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.LEDGER_BALANCE!=0 AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d,
	(	SELECT
			'NOW' acc_type,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i ,
			feature f,
			PRODUCT_FEATURE pf,
			product p 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='10' AND
			pf.feature_uid = f.feature_uid AND
			pf.PRODUCT_UID = p.PRODUCT_UID AND
			pt.UNIQUE_ID = p.PRODUCT_TYPE_ID AND
			(pf.DEFAULT_VALUE='TRUE' OR pf.DEFAULT_VALUE='True') AND
			f.FEATURE_DESC LIKE 'IS_INTEREST_BEARING' AND
			DAV.CLASS_CODE=p.PROD_SUB_TYPE_ID 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	e 
WHERE
	--e.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	--e.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	--e.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	--e.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	e.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	e.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
	-- for Savings accounts
	
SELECT
	a.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'SAV' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'SAV' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C 
WHERE
	--a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	--a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	b.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'SAV' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'SAV' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C 
WHERE
--	b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
--	b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	C.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	a.ACCRUED_INTEREST_sum,
	C.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	b.dormant_count,
	b.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'SAV' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'SAV' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'SAV' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='21' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C 
WHERE
	--C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	--C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) 
UNION
	-- for CD accounts
SELECT
	a.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	a.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	a.PRODUCT_TYPE_DESC,
	a.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'CD' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.account_type_id='22' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.account_type_id='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	--a.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	--a.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	--a.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	a.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	a.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	b.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	b.PRODUCT_TYPE_ID,
	b.PRODUCT_CATEGORY,
	b.PRODUCT_TYPE_DESC,
	b.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'CD' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.account_type_id='22' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.account_type_id='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	--b.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	--b.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
--.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	b.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+) AND
	b.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	C.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	C.PRODUCT_TYPE_ID,
	C.PRODUCT_CATEGORY,
	C.PRODUCT_TYPE_DESC,
	C.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'CD' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.account_type_id='22' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.account_type_id='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	--C.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	--C.INSTITUTION_ID=b.INSTITUTION_ID(+) AND
	--c.INSTITUTION_ID=d.INSTITUTION_ID(+) AND
	C.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	C.PRODUCT_TYPE_ID=d.PRODUCT_TYPE_ID(+) 
UNION
SELECT
	d.acc_type,
	
	a.accounts_count,
	a.ledger_balance_sum,
	
	d.PRODUCT_TYPE_ID,
	a.PRODUCT_CATEGORY,
	d.PRODUCT_TYPE_DESC,
	d.ACCOUNT_TYPE_ID,
	C.ACCRUED_INTEREST_sum,
	a.ANTICIPATED_INTEREST_sum,
	b.od_balance_sum,
	b.mat_count,
	b.mat_balance_sum,
	d.dormant_count,
	d.dormant_balance_sum,
	a.PARENT_ID,
	a.PARENT_NAME
FROM
	(	SELECT
			'CD' acc_type,
			COUNT(DAV.ACCOUNT_ID) accounts_count,
			SUM(LEDGER_BALANCE) ledger_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			DAV.account_type_id,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ANTICIPATED_INTEREST_sum,
			i.PARENT_ID,
			i.PARENT_NAME
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.account_type_id='22' AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.LEDGER_BALANCE>0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC,
			i.PARENT_ID,
			i.PARENT_NAME
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	a,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM,
			NULL DORMANT_COUNT ,
			NULL DORMANT_BALANCE_SUM ,
			COUNT(DAV.ACCOUNT_ID) mat_count,
			SUM(LEDGER_BALANCE) mat_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			(DAV.MATURITY_DATE<i.LAST_PROCESSED_DATE OR
			DAV.MATURITY_DATE BETWEEN i.LAST_PROCESSED_DATE AND
			i.NEXT_PROCESSING_DATE) AND
			DAV.account_type_id='22'AND
			LEDGER_BALANCE !=0 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	b,
	(	SELECT
			'CD' acc_type,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_DESC,
			SUM(trunc((DAV.ACCRUED_INTEREST),2)) AS ACCRUED_INTEREST_sum,
			DAV.account_type_id 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	C,
	(	SELECT
			'CD' acc_type,
			NULL OD_BALANCE_SUM ,
			NULL MAT_COUNT,
			NULL MAT_BALANCE_SUM,
			COUNT(DAV.ACCOUNT_ID) dormant_count,
			SUM(LEDGER_BALANCE) dormant_balance_sum,
			to_number(pt.PRODUCT_TYPE_ID)PRODUCT_TYPE_ID,
			
			DAV.account_type_id,
			pt.PRODUCT_TYPE_DESC 
		FROM
			
			PRODUCT_TYPE pt,
			DEPOSIT_ACCOUNT_VW DAV,
			
			INSTITUTION i 
		WHERE 
			DAV.PRODUCT_ID=pt.UNIQUE_ID AND
			
			DAV.STATUS_CODE = ('5') AND
			DAV.INSTITUTION_ID=i.INSTITUTION_ID AND
			DAV.account_type_id='22' 
		GROUP BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID,
			pt.PRODUCT_TYPE_DESC 
		ORDER BY
			DAV.account_type_id,
			pt.PRODUCT_CATEGORY,
			pt.PRODUCT_TYPE_ID
	)
	d 
WHERE
	--d.INSTITUTION_ID=a.INSTITUTION_ID(+) AND
	--d.institution_id=b.INSTITUTION_ID(+) AND
	--d.INSTITUTION_ID=C.INSTITUTION_ID(+) AND
	d.PRODUCT_TYPE_ID=a.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=b.PRODUCT_TYPE_ID(+) AND
	d.PRODUCT_TYPE_ID=C.PRODUCT_TYPE_ID(+);



-----------------Ira Contributibutions sql-------------3

CREATE OR
REPLACE VIEW IRACONTRIBUTIONS_VW AS 
SELECT i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	AHI.TRANSACTION_ID ACCOUNT_ID,
	ASG.STATEMENT_NAMES,
	SPD.PLAN_NUMBER PLANNUMBER,
	DA.ACCOUNT_NO INVESSTACCOUNTNUMBER,
	BR.BRANCH_NAME,
	AHI.POST_DATE,
	AHI.EFFECTIVE_DATE,
	AHI.AMOUNT,
	PDA.CONTRIBUTION_TYPE,
	1 AS YES 
FROM    DEPOSIT_ACCOUNT_VW DA,
	ACCOUNT_STATEMENT_GENERATOR ASG,
	BRANCH BR ,
	INSTITUTION I ,
	SAVINGS_PLAN_DETAILS SPD ,
	ACCOUNT_HISTORY_ITEM AHI ,
	INVEST_ACCT_POTENTIAL_EVENT iap,
	POTENTIAL_DEPOSIT_EVENT pda ,
	MAINTENANCE_LOG_VW ML 
WHERE DA.ACCOUNT_ID=ASG.ACCOUNT_ID AND
	DA.ACCOUNT_TYPE_ID=22 AND
	DA.INSTITUTION_ID=I.INSTITUTION_ID AND
	DA.ASSIGNED_BRANCH=BR.UNIQUE_ID AND
	DA.PLAN_ID IS NOT NULL AND
	DA.PLAN_ID=SPD.PLAN_ID AND
	DA.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	AHI.AMOUNT > 0 AND
	iap.ACCOUNT_ID = AHI.ACCOUNT_ID AND
	pda.UNIQUE_ID=iap.POT_DEPOSIT_EVENT_ID AND
	trunc(AHI.EFFECTIVE_DATE) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND
	DA.ACCOUNT_ID=ML.ACCOUNT_ID AND
	ML.FIELD_CHANGED LIKE 'CD.statusCode' AND
	ML.CHANGE_FROM LIKE'PENDING_NEW' AND
	ML.CHANGE_TO LIKE 'NEW_ACCOUNT' AND  AHI.POSTED_TO=1 AND
	trunc(ml.EFFECTIVE_DATE_FROM) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND AHI.SOURCE_TRANS_CODE IN (202,231,232) AND AHI.SOURCE_NAME NOT LIKE 'INTERNAL'
ORDER BY SPD.PLAN_NUMBER;

CREATE OR
REPLACE VIEW IRACONTRIBUTIONSMISC_VW AS 
SELECT i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	AHI.TRANSACTION_ID ACCOUNT_ID,
	ASG.STATEMENT_NAMES,
	SPD.PLAN_NUMBER PLANNUMBER,
	DA.ACCOUNT_NO INVESSTACCOUNTNUMBER,
	BR.BRANCH_NAME,
	AHI.POST_DATE,
	AHI.EFFECTIVE_DATE,
	AHI.AMOUNT,
	PDA.CONTRIBUTION_TYPE,
	0 AS NO 
FROM DEPOSIT_ACCOUNT_VW DA,
	ACCOUNT_STATEMENT_GENERATOR ASG,
	BRANCH BR ,
	INSTITUTION I ,
	SAVINGS_PLAN_DETAILS SPD ,
	ACCOUNT_HISTORY_ITEM AHI ,
	INVEST_ACCT_POTENTIAL_EVENT iap,
	POTENTIAL_DEPOSIT_EVENT pda ,
	MAINTENANCE_LOG_VW ML 
WHERE DA.ACCOUNT_ID=ASG.ACCOUNT_ID AND
	DA.ACCOUNT_TYPE_ID=22 AND
	DA.INSTITUTION_ID=I.INSTITUTION_ID AND
	DA.ASSIGNED_BRANCH=BR.UNIQUE_ID AND
	DA.PLAN_ID IS NOT NULL AND
	DA.PLAN_ID=SPD.PLAN_ID AND
	DA.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	AHI.AMOUNT > 0 AND
	iap.ACCOUNT_ID = AHI.ACCOUNT_ID AND
	pda.UNIQUE_ID=iap.POT_DEPOSIT_EVENT_ID AND
	AHI.POSTED_TO=1 AND
	trunc(AHI.EFFECTIVE_DATE) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND
	DA.ACCOUNT_ID=ML.ACCOUNT_ID AND
    ML.FIELD_CHANGED  LIKE 'CD.statusCode' AND
	ML.CHANGE_FROM NOT LIKE'PENDING_NEW' AND
	ML.CHANGE_TO NOT LIKE 'NEW_ACCOUNT' AND
	trunc(ml.EFFECTIVE_DATE_FROM) not between trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND AHI.SOURCE_NAME NOT LIKE 'INTERNAL' AND  AHI.SOURCE_TRANS_CODE IN (202,231,232)
ORDER BY SPD.PLAN_NUMBER;


CREATE OR
REPLACE VIEW IRATOTALCONTRIBUTIONS_VW AS
SELECT i.INSTITUTION_ID,
	   i.INSTITUTION_NAME,
	   PDA.CONTRIBUTION_TYPE,
	   sum(AHI.AMOUNT) as amount
FROM    DEPOSIT_ACCOUNT_VW DA,
	ACCOUNT_STATEMENT_GENERATOR ASG,
	BRANCH BR ,
	INSTITUTION I ,
	SAVINGS_PLAN_DETAILS SPD ,
	ACCOUNT_HISTORY_ITEM AHI ,
	INVEST_ACCT_POTENTIAL_EVENT iap,
	POTENTIAL_DEPOSIT_EVENT pda 

WHERE DA.ACCOUNT_ID=ASG.ACCOUNT_ID AND
	DA.ACCOUNT_TYPE_ID=22 AND
	DA.INSTITUTION_ID=I.INSTITUTION_ID AND
	DA.ASSIGNED_BRANCH=BR.UNIQUE_ID AND
	DA.PLAN_ID IS NOT NULL AND
	DA.PLAN_ID=SPD.PLAN_ID AND
	DA.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	AHI.AMOUNT > 0 AND
	iap.ACCOUNT_ID = AHI.ACCOUNT_ID AND
	pda.UNIQUE_ID=iap.POT_DEPOSIT_EVENT_ID AND
	AHI.POSTED_TO=1 AND
	trunc(AHI.EFFECTIVE_DATE) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND
	 AHI.SOURCE_TRANS_CODE IN (202,231,232) AND AHI.SOURCE_NAME NOT LIKE 'INTERNAL'
group by  i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	PDA.CONTRIBUTION_TYPE
order by  i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	PDA.CONTRIBUTION_TYPE;

CREATE OR
REPLACE VIEW IRAREGULARDISTRIBUTIONS_VW AS 
SELECT 
	distinct(AHI.TRANSACTION_ID) ACCOUNT_ID,
	i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	ASG.STATEMENT_NAMES,
	SPD.PLAN_NUMBER PLANNUMBER,
	DA.ACCOUNT_NO INVESSTACCOUNTNUMBER,
	BR.BRANCH_NAME,
	AHI.POST_DATE,
	AHI.EFFECTIVE_DATE,
	AHI.AMOUNT,
	SPDI.DISTRIBUTION_CODE,
	1 AS YES ,
	SPDI.ENTERED_BY
FROM DEPOSIT_ACCOUNT_VW DA,
	ACCOUNT_STATEMENT_GENERATOR ASG,
	BRANCH BR ,
	INSTITUTION I ,
	SAVINGS_PLAN_DETAILS SPD ,
	ACCOUNT_HISTORY_ITEM AHI,
	SAVINGS_PLAN_DISTRIB_INSTR SPDI 
WHERE DA.ACCOUNT_ID=ASG.ACCOUNT_ID AND
	DA.ACCOUNT_TYPE_ID=22 AND
	DA.INSTITUTION_ID=I.INSTITUTION_ID AND
	DA.ASSIGNED_BRANCH=BR.UNIQUE_ID AND
	DA.PLAN_ID IS NOT NULL AND
	DA.PLAN_ID=SPD.PLAN_ID AND
	DA.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	AHI.AMOUNT < 0 AND
	SPDI.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	SPDI.PLAN_ID=SPD.PLAN_ID AND
	AHI.POSTED_TO=1 AND
	trunc(AHI.EFFECTIVE_DATE) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND
	AHI.SOURCE_NAME NOT LIKE 'INTERNAL' AND SPDI.DISTRIBUTION_CODE IS NOT NULL 
ORDER BY SPD.PLAN_NUMBER;





CREATE OR
REPLACE VIEW IRAMISCDISTRIBUTIONSMISC_VW AS 
SELECT

distinct(AHI.TRANSACTION_ID) ACCOUNT_ID,
i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	
	ASG.STATEMENT_NAMES,
	SPD.PLAN_NUMBER PLANNUMBER,
	DA.ACCOUNT_NO INVESSTACCOUNTNUMBER,
	BR.BRANCH_NAME,
	AHI.POST_DATE,
	AHI.EFFECTIVE_DATE,
	AHI.AMOUNT,
	SPDI.DISTRIBUTION_CODE,
	0 AS NO ,
	SPDI.ENTERED_BY
FROM DEPOSIT_ACCOUNT_VW DA,
	ACCOUNT_STATEMENT_GENERATOR ASG,
	BRANCH BR ,
	INSTITUTION I ,
	SAVINGS_PLAN_DETAILS SPD ,
	ACCOUNT_HISTORY_ITEM AHI,
	SAVINGS_PLAN_DISTRIB_INSTR SPDI 
WHERE DA.ACCOUNT_ID=ASG.ACCOUNT_ID AND
	DA.ACCOUNT_TYPE_ID=22 AND
	DA.INSTITUTION_ID=I.INSTITUTION_ID AND
	DA.ASSIGNED_BRANCH=BR.UNIQUE_ID AND
	DA.PLAN_ID IS NOT NULL AND
	DA.PLAN_ID=SPD.PLAN_ID AND
	DA.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	AHI.AMOUNT < 0 AND
	SPDI.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	SPDI.PLAN_ID=SPD.PLAN_ID AND
	AHI.POSTED_TO=1 AND
	trunc(AHI.EFFECTIVE_DATE) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND
	AHI.SOURCE_NAME NOT LIKE 'INTERNAL' AND SPDI.DISTRIBUTION_CODE IS NULL 
ORDER BY SPD.PLAN_NUMBER;


CREATE OR
REPLACE VIEW IRATOTALDISTRIBUTIONS_VW AS
SELECT i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	SPDI.DISTRIBUTION_CODE as CONTRIBUTION_TYPE,
	sum(AHI.AMOUNT) as amount
	
FROM DEPOSIT_ACCOUNT_VW DA,
	ACCOUNT_STATEMENT_GENERATOR ASG,
	BRANCH BR ,
	INSTITUTION I ,
	SAVINGS_PLAN_DETAILS SPD ,
	ACCOUNT_HISTORY_ITEM AHI,
	SAVINGS_PLAN_DISTRIB_INSTR SPDI 
WHERE DA.ACCOUNT_ID=ASG.ACCOUNT_ID AND
	DA.ACCOUNT_TYPE_ID=22 AND
	DA.INSTITUTION_ID=I.INSTITUTION_ID AND
	DA.ASSIGNED_BRANCH=BR.UNIQUE_ID AND
	DA.PLAN_ID IS NOT NULL AND
	DA.PLAN_ID=SPD.PLAN_ID AND
	DA.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	AHI.AMOUNT < 0 AND
	SPDI.ACCOUNT_ID=AHI.ACCOUNT_ID AND
	SPDI.PLAN_ID=SPD.PLAN_ID AND
	AHI.POSTED_TO=1 AND
	trunc(AHI.EFFECTIVE_DATE) BETWEEN trunc(I.LAST_PROCESSED_DATE) AND
	trunc(I.NEXT_PROCESSING_DATE) AND
	AHI.SOURCE_NAME NOT LIKE 'INTERNAL'  
group by i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	SPDI.DISTRIBUTION_CODE
order by 
i.INSTITUTION_ID,
	i.INSTITUTION_NAME,
	SPDI.DISTRIBUTION_CODE;
	
	------	Remmittance Daily Report --update
CREATE OR REPLACE FORCE VIEW "REMITTANCE_DAILY_REPORTS_VIEW" AS

SELECT distinct(bh.CUSTOMER_ID),dv.MTD_BKP_WITHHOLDING,dv.YTD_BKP_WITHHOLDING,dv.BRANCH_ID,
B.BRANCH_NAME,decode(p.FIRST_NAME,null,o.business_name,p.first_name||p.middle_name||p.last_name) first_name,
d.ACCOUNT_NO,parv.RESPONSIBILITY_TYPE,dv.LAST_REMITTED_AMT,d.ACCOUNT_TYPE_ID,dv.account_id,i.institution_id,
i.institution_name,pid.party_registerd_id,bh.NOTIFICATION_DATE,bh.NOTICE_PRINT_DATE,dv.UNREMITTED_BKP_WTHOLD_AMT,
bh.STATUS,bh.BKP_WITHHOLDING_ENTRY_DATE,bh.USER_NAME


from deposit_account dv,
DEPOSIT_ACCOUNT_VW d,
party_account_role_vw parv,
PARTY_INSTITUTION_ASSOCIATION pia,
BACKUP_WITHHOLDING bh,

BRANCH B,(select * from party_registered_ids pid where type in ('SSN','TIN')) pid,
person p,organization o,institution i

where dv.account_id=parv.ACCOUNT_ID and d.INSTITUTION_ID = i.INSTITUTION_ID and parv.PARTY_ID = pia.party_id

and bh.customer_id = pia.UNIQUE_ASSOCIATION_ID
and dv.BRANCH_ID=B.UNIQUE_ID
and d.ACCOUNT_ID=dv.ACCOUNT_ID and parv.party_id=pid.party_id and p.party_id(+)=parv.party_id and o.party_id(+)=parv.party_id
and parv.RESPONSIBILITY_TYPE in ('9')
and d.ACCOUNT_CATEGORY in ('1')
and d.STATUS_CODE in ('0','1','2','3')
and nvl(d.Interest_code,'3') not in ('0','1') 
and TRUNC(bh.BKP_WITHHOLDING_ENTRY_DATE) =TRUNC(i.LAST_PROCESSED_DATE) 
and dv.LAST_REMITTED_AMT >0

 
order by dv.BRANCH_ID asc,dv.LAST_REMITTED_AMT asc;


-----------Total Backup Accounts Report---
	
CREATE OR REPLACE FORCE VIEW "TOTAL_BKP_ACC_REP_VW" AS

SELECT distinct(bh.CUSTOMER_ID),bh.NOTIFICATION_TYPE,dv.MTD_BKP_WITHHOLDING,dv.YTD_BKP_WITHHOLDING,dv.BRANCH_ID,
B.BRANCH_NAME,decode(p.FIRST_NAME,null,o.business_name,p.first_name||p.middle_name||p.last_name) first_name,
d.ACCOUNT_NO,parv.RESPONSIBILITY_TYPE,dv.LAST_REMITTED_AMT,d.ACCOUNT_TYPE_ID,dv.account_id,i.institution_id,
i.institution_name,pid.party_registerd_id,bh.TAX_YEAR,bh.NOTIFICATION_DATE,bh.NOTICE_PRINT_DATE,dv.UNREMITTED_BKP_WTHOLD_AMT,
bh.STATUS,bh.BKP_WITHHOLDING_ENTRY_DATE,bh.USER_NAME


from deposit_account dv,
DEPOSIT_ACCOUNT_VW d,
party_account_role_vw parv,
PARTY_INSTITUTION_ASSOCIATION pia,
BACKUP_WITHHOLDING bh,

BRANCH B,(select * from party_registered_ids pid where type in ('SSN','TIN')) pid,
person p,organization o,institution i

where dv.account_id=parv.ACCOUNT_ID and d.INSTITUTION_ID = i.INSTITUTION_ID and parv.PARTY_ID = pia.party_id

and bh.customer_id = pia.UNIQUE_ASSOCIATION_ID
and dv.BRANCH_ID=B.UNIQUE_ID
and d.ACCOUNT_ID=dv.ACCOUNT_ID and parv.party_id=pid.party_id and p.party_id(+)=parv.party_id and o.party_id(+)=parv.party_id
and parv.RESPONSIBILITY_TYPE in ('9')
and d.ACCOUNT_CATEGORY in ('1')
and d.STATUS_CODE in ('0','1','2','3')
and nvl(d.Interest_code,'3') not in ('0','1') 
and TRUNC(bh.BKP_WITHHOLDING_ENTRY_DATE) = TRUNC(i.LAST_PROCESSED_DATE) 

 
order by dv.BRANCH_ID asc,dv.UNREMITTED_BKP_WTHOLD_AMT asc;








